machine:
  services:
     - docker
checkout:
  override:
    - git clone --branch $CIRCLE_TAG git@github.com:sxend/Dockerfiles.git
dependencies:
  override:
    - sed "s/<EMAIL>/$DOCKER_EMAIL/;s/<AUTH>/$DOCKER_AUTH/" < .dockercfg.template > ~/.dockercfg
database:
  override:
    - echo skip database
test:
  override:
    - echo test skip
deployment:
  master:
    branch: master
    commands:
      - exit 0
  release:
    tag: /.*/
    commands:
      - ./build.sh $CIRCLE_USERNAME $CIRCLE_TAG
  ubuntu14.04:
    branch: /ubuntu14.04\/.*/
    commands:
      - ./build.sh $CIRCLE_USERNAME $CIRCLE_BRANCH
  cassandra2.1.0:
    branch: /cassandra2.1.0\/.*/
    commands:
      - ./build.sh $CIRCLE_USERNAME $CIRCLE_BRANCH
  cassandra2.1.2:
    branch: /cassandra2.1.2\/.*/
    commands:
      - ./build.sh $CIRCLE_USERNAME $CIRCLE_BRANCH
  nginx:
    branch: /nginx\/.*/
    commands:
      - ./build.sh $CIRCLE_USERNAME $CIRCLE_BRANCH
  sonatype-nexus:
    branch: /sonatype-nexus\/.*/
    commands:
      - ./build.sh $CIRCLE_USERNAME $CIRCLE_BRANCH
  apache-archiva:
    branch: /apache-archiva\/.*/
    commands:
      - ./build.sh $CIRCLE_USERNAME $CIRCLE_BRANCH
  nghttp2:
    branch: /nghttp2\/.*/
    commands:
      - ./build.sh $CIRCLE_USERNAME $CIRCLE_BRANCH
#  example:
#    branch: /example\/.*/
#    commands:
#      - ./build.sh $CIRCLE_USERNAME $CIRCLE_BRANCH
